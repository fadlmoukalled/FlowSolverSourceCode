c
C#############################################################################################
      SUBROUTINE maskedSwapDPvariables(a,b,mask)
C#############################################################################################
      implicit none
c*********************************************************************************************
      double precision, intent(INOUT) :: a,b
      logical, intent(IN) :: mask
      double precision :: swp
c*********************************************************************************************
c
      if (mask) then
c
        swp=a
        a=b
        b=swp
c
      endif
c
      return
      end
